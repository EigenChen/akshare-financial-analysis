# Streamlit 财务分析工具使用说明

## 📋 简介

这是一个基于 Streamlit 构建的 Web 版财务分析工具，提供了友好的图形界面来使用财务分析功能。

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行应用

```bash
streamlit run streamlit_app.py
```

应用会自动在浏览器中打开，默认地址：`http://localhost:8501`

## 📖 使用指南

### 界面布局

- **左侧边栏**：参数设置区域
  - 股票代码输入
  - 年份范围选择
  - 分析模块选择
  - 开始分析按钮

- **主内容区**：结果显示区域
  - 分析进度显示
  - 数据表格展示
  - 可视化图表
  - Excel 文件下载

### 使用步骤

1. **输入股票代码**
   - 在左侧边栏的"股票代码"输入框中输入6位股票代码
   - 例如：`603486`（科沃斯）、`600519`（贵州茅台）

2. **选择年份范围**
   - 设置"起始年份"和"结束年份"
   - 建议选择5-10年的范围

3. **选择分析模块**
   - 勾选需要分析的模块
   - 可以全选，也可以只选择部分模块

4. **开始分析**
   - 点击"🚀 开始分析"按钮
   - 等待分析完成（首次可能需要较长时间）

5. **查看结果**
   - 在标签页中查看不同模块的分析结果
   - 可以查看数据表格和可视化图表

6. **下载报告**
   - 点击"📥 下载完整Excel报告"按钮
   - 下载包含所有分析结果的Excel文件

## 🎨 功能特点

### 1. 交互式界面
- 友好的 Web 界面，无需命令行操作
- 实时进度显示
- 结果可视化展示

### 2. 模块化分析
- 7个独立的分析模块
- 可以自由选择需要分析的模块
- 每个模块结果独立展示

### 3. 数据可视化
- 自动生成图表
- 支持交互式图表（Plotly）
- 可以切换不同的指标查看

### 4. 一键导出
- 自动生成Excel报告
- 包含所有分析结果
- 支持直接下载

## 📊 分析模块说明

1. **营收基本数据**
   - 收入、净利润、现金流等核心指标
   - 金融利润、经营利润分析

2. **费用构成**
   - 毛利率、净利率
   - 各项费用率分析

3. **增长率**
   - 年度增长率
   - 复合增长率（3年/5年）

4. **资产负债**
   - 资产结构分析
   - 债务结构分析

5. **WC分析**
   - 营运资金相关指标
   - 营运资金与收入的关系

6. **固定资产投入分析**
   - 固定资产与收入的关系
   - 长期资产分析

7. **人均数据**
   - 人均收入、人均利润
   - 人均薪酬分析

## ⚠️ 注意事项

1. **数据获取时间**
   - 首次分析可能需要较长时间（数据获取）
   - 建议耐心等待，不要重复点击

2. **数据完整性**
   - 某些股票可能缺少部分年份的数据
   - 缺失数据会显示为 "-"

3. **网络连接**
   - 需要稳定的网络连接来获取数据
   - 如果失败，可以重试

4. **年份范围**
   - 建议选择合理的年份范围
   - 过大的范围可能导致分析时间较长

## 🔧 技术栈

- **Streamlit**：Web 界面框架
- **Plotly**：数据可视化
- **Pandas**：数据处理
- **AKShare**：财务数据获取

## 📝 示例

### 分析科沃斯（603486）2013-2021年数据

1. 输入股票代码：`603486`
2. 设置起始年份：`2013`
3. 设置结束年份：`2021`
4. 勾选所有分析模块
5. 点击"开始分析"
6. 等待分析完成
7. 查看结果并下载报告

## 🐛 常见问题

### Q: 应用无法启动？
A: 检查是否安装了所有依赖：`pip install -r requirements.txt`

### Q: 分析失败？
A: 检查网络连接，确保可以访问数据源。某些股票可能没有数据。

### Q: 图表不显示？
A: 某些模块可能不支持图表可视化，这是正常的。

### Q: Excel文件下载失败？
A: 检查 `output` 目录是否存在，确保有写入权限。

## 📚 学习资源

- [Streamlit 官方文档](https://docs.streamlit.io/)
- [Plotly 文档](https://plotly.com/python/)
- [AKShare 文档](https://akshare.akfamily.xyz/)

