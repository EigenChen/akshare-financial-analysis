# æ¸¯è‚¡å‘˜å·¥æ•°æ®è·å–è¯´æ˜

## ğŸ“Š æ•°æ®è·å–æ–¹å¼

### æ–¹å¼1ï¼šä»å¹´æŠ¥PDFä¸­æå–ï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… å¯ä»¥è·å–å¤šå¹´å†å²æ•°æ®
- âœ… æ•°æ®å‡†ç¡®ï¼ˆæ¥è‡ªå®˜æ–¹å¹´æŠ¥ï¼‰
- âœ… æ”¯æŒä¸­è‹±æ–‡å¹´æŠ¥

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦å…ˆä¸‹è½½å¹´æŠ¥PDF
- âš ï¸ æå–è¿‡ç¨‹å¯èƒ½è¾ƒæ…¢

### æ–¹å¼2ï¼šé€šè¿‡AKShareæ¥å£è·å–ï¼ˆä»…æœ€æ–°ä¸€å¹´ï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… å¿«é€Ÿä¾¿æ·
- âœ… æ— éœ€ä¸‹è½½PDF

**ç¼ºç‚¹**ï¼š
- âŒ åªèƒ½è·å–æœ€æ–°ä¸€å¹´çš„æ•°æ®
- âŒ æ— æ³•è·å–å†å²æ•°æ®

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šä»PDFæå–å‘˜å·¥æ•°é‡

#### å•ä¸ªPDFæå–

```python
from æ¸¯è‚¡_ä»å¹´æŠ¥æå–å‘˜å·¥æ•°é‡ import extract_employee_count_from_hk_pdf

# æå–å•ä¸ªPDFçš„å‘˜å·¥æ•°é‡
pdf_path = "å¹´æŠ¥PDF/00700_2024å¹´å¹´åº¦æŠ¥å‘Š.pdf"
count = extract_employee_count_from_hk_pdf(pdf_path, verbose=True)

if count:
    print(f"å‘˜å·¥æ•°é‡: {count:,} äºº")
```

#### æ‰¹é‡æå–

```python
from æ¸¯è‚¡_ä»å¹´æŠ¥æå–å‘˜å·¥æ•°é‡ import batch_extract_employee_count_from_pdfs

# æ‰¹é‡æå–ç›®å½•ä¸­æ‰€æœ‰PDFçš„å‘˜å·¥æ•°é‡
pdf_dir = "å¹´æŠ¥PDF"
results = batch_extract_employee_count_from_pdfs(
    pdf_dir, 
    output_csv="æ¸¯è‚¡å‘˜å·¥æ•°é‡.csv"  # å¯é€‰ï¼šä¿å­˜åˆ°CSV
)

# æŸ¥çœ‹ç»“æœ
for filename, count in results.items():
    if count:
        print(f"{filename}: {count:,} äºº")
```

#### æŒ‰å¹´ä»½æå–

```python
from æ¸¯è‚¡_ä»å¹´æŠ¥æå–å‘˜å·¥æ•°é‡ import extract_employee_count_by_year_from_pdfs

# æå–æŒ‡å®šå¹´ä»½èŒƒå›´çš„å‘˜å·¥æ•°é‡
pdf_dir = "å¹´æŠ¥PDF"
symbol = "00700"
results = extract_employee_count_by_year_from_pdfs(
    pdf_dir, symbol, 2020, 2024
)

# æŸ¥çœ‹ç»“æœ
for year, count in results.items():
    if count:
        print(f"{year}å¹´: {count:,} äºº")
```

### æ–¹æ³•2ï¼šé€šè¿‡æ¥å£è·å–ï¼ˆä»…æœ€æ–°ä¸€å¹´ï¼‰

```python
from hk_financial_adapter import get_hk_employee_count

# è·å–æœ€æ–°å‘˜å·¥äººæ•°
count = get_hk_employee_count('00700')
if count:
    print(f"å‘˜å·¥äººæ•°: {count:,} äºº")
```

## ğŸ“ ç”Ÿæˆå‘˜å·¥æ•°é‡CSVæ–‡ä»¶

æå–å®Œæˆåï¼Œéœ€è¦ç”Ÿæˆç¬¦åˆè´¢åŠ¡åˆ†æå·¥å…·è¦æ±‚çš„CSVæ–‡ä»¶æ ¼å¼ï¼š

**æ–‡ä»¶æ ¼å¼**ï¼š`{è‚¡ç¥¨ä»£ç }_å‘˜å·¥æ•°é‡.csv`

**å†…å®¹æ ¼å¼**ï¼š
```csv
å¹´ä»½,å‘˜å·¥æ•°é‡
2020,62885
2021,68226
2022,74317
2023,106836
2024,115076
```

**ç¤ºä¾‹ä»£ç **ï¼š
```python
import csv

# ä»PDFæå–çš„æ•°æ®
employee_data = {
    2020: 62885,
    2021: 68226,
    2022: 74317,
    2023: 106836,
    2024: 115076
}

# ä¿å­˜ä¸ºCSV
symbol = "00700"
csv_path = f"{symbol}_å‘˜å·¥æ•°é‡.csv"

with open(csv_path, 'w', newline='', encoding='utf-8-sig') as f:
    writer = csv.writer(f)
    writer.writerow(['å¹´ä»½', 'å‘˜å·¥æ•°é‡'])
    for year in sorted(employee_data.keys()):
        writer.writerow([year, employee_data[year]])

print(f"[OK] å‘˜å·¥æ•°é‡CSVå·²ä¿å­˜: {csv_path}")
```

## ğŸ”„ åœ¨è´¢åŠ¡åˆ†æä¸­ä½¿ç”¨

### æ–¹æ³•1ï¼šåœ¨Streamlitç•Œé¢ä¸­ä½¿ç”¨

1. è¿è¡Œ `å¯åŠ¨æ¸¯è‚¡åº”ç”¨.bat`
2. åœ¨ä¾§è¾¹æ é€‰æ‹©"ğŸ†• æ–°å»ºåˆ†æ"
3. è¾“å…¥æ¸¯è‚¡ä»£ç å’Œå¹´ä»½èŒƒå›´
4. ä¸Šä¼ å‘˜å·¥æ•°é‡CSVæ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰
5. ç‚¹å‡»"ğŸš€ å¼€å§‹åˆ†æ"

### æ–¹æ³•2ï¼šåœ¨è„šæœ¬ä¸­ä½¿ç”¨

```python
from hk_financial_analysis_full import calculate_per_capita_metrics

# æŒ‡å®šå‘˜å·¥æ•°é‡CSVæ–‡ä»¶è·¯å¾„
employee_csv_path = "00700_å‘˜å·¥æ•°é‡.csv"

# è®¡ç®—äººå‡æ•°æ®ï¼ˆä¼šè‡ªåŠ¨ä½¿ç”¨CSVä¸­çš„å‘˜å·¥æ•°é‡ï¼‰
per_capita_df = calculate_per_capita_metrics(
    '00700', 
    2020, 
    2024, 
    employee_csv_path=employee_csv_path
)
```

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `æ¸¯è‚¡_ä»å¹´æŠ¥æå–å‘˜å·¥æ•°é‡.py` - æ¸¯è‚¡å¹´æŠ¥PDFå‘˜å·¥æ•°é‡æå–è„šæœ¬
- `hk_financial_adapter.py` - æ¸¯è‚¡é€‚é…å±‚ï¼ˆåŒ…å«æ¥å£è·å–å‡½æ•°ï¼‰
- `æµ‹è¯•_ä»å¹´æŠ¥æå–å‘˜å·¥æ•°é‡.py` - Aè‚¡ç‰ˆæœ¬ï¼ˆå¯å‚è€ƒï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **PDFæ–‡ä»¶å‘½å**ï¼š
   - å»ºè®®ä½¿ç”¨æ ¼å¼ï¼š`{è‚¡ç¥¨ä»£ç }_{å¹´ä»½}å¹´å¹´åº¦æŠ¥å‘Š.pdf`
   - ä¾‹å¦‚ï¼š`00700_2024å¹´å¹´åº¦æŠ¥å‘Š.pdf`

2. **PDFæ–‡ä»¶ä½ç½®**ï¼š
   - é»˜è®¤åœ¨ `å¹´æŠ¥PDF` ç›®å½•
   - å¯ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„è·¯å¾„

3. **æå–å‡†ç¡®æ€§**ï¼š
   - æå–ç®—æ³•ä¼šå°è¯•å¤šç§å…³é”®è¯åŒ¹é…
   - å¦‚æœæå–å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨æ£€æŸ¥PDFä¸­çš„"å‘˜å·¥æƒ…å†µ"ç« èŠ‚
   - å»ºè®®éªŒè¯æå–ç»“æœçš„åˆç†æ€§

4. **å¹´æŠ¥ä¸‹è½½**ï¼š
   - æ¸¯è‚¡å¹´æŠ¥å¯ä»¥ä»æ¸¯äº¤æ‰€å®˜ç½‘ä¸‹è½½
   - æˆ–ä½¿ç”¨å…¶ä»–æ•°æ®æº

## âœ… æ¨èå·¥ä½œæµç¨‹

1. **ä¸‹è½½å¹´æŠ¥PDF**ï¼š
   - ä»æ¸¯äº¤æ‰€å®˜ç½‘ä¸‹è½½æ‰€éœ€å¹´ä»½çš„å¹´æŠ¥PDF
   - ä¿å­˜åˆ° `å¹´æŠ¥PDF` ç›®å½•

2. **æå–å‘˜å·¥æ•°é‡**ï¼š
   ```python
   from æ¸¯è‚¡_ä»å¹´æŠ¥æå–å‘˜å·¥æ•°é‡ import extract_employee_count_by_year_from_pdfs
   
   results = extract_employee_count_by_year_from_pdfs(
       "å¹´æŠ¥PDF", "00700", 2020, 2024
   )
   ```

3. **ç”ŸæˆCSVæ–‡ä»¶**ï¼š
   ```python
   import csv
   
   with open("00700_å‘˜å·¥æ•°é‡.csv", 'w', newline='', encoding='utf-8-sig') as f:
       writer = csv.writer(f)
       writer.writerow(['å¹´ä»½', 'å‘˜å·¥æ•°é‡'])
       for year, count in sorted(results.items()):
           if count:
               writer.writerow([year, count])
   ```

4. **ä½¿ç”¨CSVæ–‡ä»¶**ï¼š
   - åœ¨è´¢åŠ¡åˆ†æå·¥å…·ä¸­ä¸Šä¼ CSVæ–‡ä»¶
   - æˆ–ç›´æ¥åœ¨è„šæœ¬ä¸­æŒ‡å®šCSVè·¯å¾„

---

**æ›´æ–°æ—¥æœŸ**ï¼š2025-12-15  
**æ¨èæ–¹å¼**ï¼šä»å¹´æŠ¥PDFæå–ï¼ˆå¯è·å–å¤šå¹´å†å²æ•°æ®ï¼‰
